<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Utin - Portfolio</title>
<link id="npc-design" rel="stylesheet" href=""> <!-- NPC design loaded dynamically -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');

body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: black;
    font-family: 'Fira Code', monospace;
    box-sizing: border-box;
    height: 100vh;
    image-rendering: pixelated;
}

#game-container {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

#world {
    position: absolute;
    bottom: 0;
    left: 0;
    height: 100%;
    will-change: transform;
}

#background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("image/Battleground2.png");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    z-index: 0;
}

#player {
    position: absolute;
    background-image: url('image/player.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    z-index: 20;
}

.npc {
    position: absolute;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    cursor: pointer;
    z-index: 15;
    transition: transform 0.2s;
}

.npc:hover {
    transform: translateY(-4px);
}

.npc-name {
    position: absolute;
    color: white;
    font-size: 8px;
    text-align: center;
    z-index: 16;
    background: rgba(0,0,0,0.8);
    padding: 2px 6px;
    border: 1px solid rgba(255,255,255,0.2);
    white-space: nowrap;
    text-transform: uppercase;
}

#top-menu {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 100px;
    background: rgba(0,0,0,0.8);
    border-bottom: 4px solid rgba(255,255,255,0.2);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 40px;
    z-index: 100;
    color: white;
}

.menu-title {
    color: #fbbf24;
    font-size: 28px;
    font-weight: bold;
    letter-spacing: 4px;
}

.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    backdrop-filter: blur(8px);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 200;
}

#guide {
    position: absolute;
    bottom: 30px;
    right: 30px;
    background: rgba(0,0,0,0.6);
    border: 2px solid rgba(255,255,255,0.1);
    padding: 8px;
    display: flex;
    align-items: center;
    gap: 10px;
    z-index: 100;
    color: rgba(255,255,255,0.5);
}

.wasd-grid {
    display: grid;
    grid-template-areas: ". w ." "a s d";
    gap: 4px;
}

.key {
    width: 25px;
    height: 25px;
    border: 1px solid rgba(255,255,255,0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 8px;
    background: rgba(255,255,255,0.05);
}
</style>
</head>
<body>
<div id="game-container">
    <nav id="top-menu">
        <div class="menu-title">UTS HALL</div>
    </nav>

    <div id="world">
        <div id="background"></div>
        <div id="player"></div>
    </div>

    <div id="modal-container" class="modal-overlay" onclick="closeMenu()">
        <div class="menu" onclick="event.stopPropagation()">
            <div id="portfolio-target">Loading...</div>
            <div class="menu-close" onclick="closeMenu()">[CLOSE]</div>
        </div>
    </div>

    <div id="guide">
        <div class="wasd-grid">
            <div class="key" style="grid-area: w">W</div>
            <div class="key" style="grid-area: a">A</div>
            <div class="key" style="grid-area: s">S</div>
            <div class="key" style="grid-area: d">D</div>
        </div>
        <div class="guide-text">MOVE</div>
    </div>
</div>

<script>
const WORLD_WIDTH = 1800;
const GROUND_HEIGHT = 380;
const PLAYER_WIDTH = 140;
const PLAYER_HEIGHT = 180;
const PLAYER_SPEED = 9;

// NPC data
const npcData = [
    {id:1, x:400, name:"Antoine", img:"image/Antoine.png", design:"antoine/antoine.css", content:"antoine.html"},
    {id:2, x:650, name:"Daniel", img:"image/daniel.png", design:"daniel/daniel.css", content:"daniel.html"},
    {id:3, x:900, name:"Justine", img:"image/Justine.png", design:"justine/justine.css", content:"justine.html"},
    {id:4, x:1150, name:"Kris Karl", img:"image/kriskarl.png", design:"karl/karl.css", content:"karl.html"},
    {id:5, x:1400, name:"Kurt", img:"image/Kurt.png", design:"kurt/kurt.css", content:"kurt.html"},
    {id:6, x:1650, name:"Will", img:"image/will.png", design:"will/will.css", content:"will.html"}
];

const worldEl = document.getElementById('world');
const playerEl = document.getElementById('player');
const backgroundEl = document.getElementById('background');
const modalContainer = document.getElementById('modal-container');
const portfolioTarget = document.getElementById('portfolio-target');
const npcDesignLink = document.getElementById('npc-design');

// Set player dimensions
worldEl.style.width = WORLD_WIDTH + 'px';
backgroundEl.style.width = WORLD_WIDTH + 'px';
playerEl.style.width = PLAYER_WIDTH + 'px';
playerEl.style.height = PLAYER_HEIGHT + 'px';

// Spawn NPCs
npcData.forEach(npc=>{
    const el = document.createElement('div');
    el.className='npc';
    el.style.width = PLAYER_WIDTH + 'px';
    el.style.height = PLAYER_HEIGHT + 'px';
    el.style.left = npc.x+'px';
    el.style.bottom='50px';
    el.style.backgroundImage=`url(${npc.img})`;
    el.onclick = ()=>openNPC(npc); // open NPC menu

    worldEl.appendChild(el);

    const nameEl = document.createElement('div');
    nameEl.className='npc-name';
    nameEl.innerText=npc.name;
    nameEl.style.left=npc.x+'px';
    nameEl.style.bottom=(50 + PLAYER_HEIGHT + 10)+'px';
    worldEl.appendChild(nameEl);
});

// Open NPC modal
async function openNPC(npc){
    modalContainer.style.display='flex';
    npcDesignLink.href = npc.design; // load NPC-specific design
    try{
        const res = await fetch(npc.content);
        if(!res.ok) throw new Error('Error loading NPC content');
        portfolioTarget.innerHTML = await res.text();
    }catch(e){
        portfolioTarget.innerHTML='<p>Error loading content</p>';
    }
}

function closeMenu(){
    modalContainer.style.display='none';
}

// Player movement
let playerX=200, playerY=50;
const keys={};
window.addEventListener('keydown',e=>keys[e.key.toLowerCase()]=true);
window.addEventListener('keyup',e=>keys[e.key.toLowerCase()]=false);

function gameLoop(){
    if(keys['a']||keys['arrowleft']) playerX-=PLAYER_SPEED;
    if(keys['d']||keys['arrowright']) playerX+=PLAYER_SPEED;
    if(keys['w']||keys['arrowup']) playerY+=PLAYER_SPEED;
    if(keys['s']||keys['arrowdown']) playerY-=PLAYER_SPEED;

    playerX=Math.max(0,Math.min(playerX,WORLD_WIDTH-PLAYER_WIDTH));
    playerY=Math.max(0,Math.min(playerY,GROUND_HEIGHT-5));

    playerEl.style.left=playerX+'px';
    playerEl.style.bottom=playerY+'px';

    const cameraX=Math.max(0,Math.min(playerX+PLAYER_WIDTH/2-window.innerWidth/2,WORLD_WIDTH-window.innerWidth));
    worldEl.style.transform=`translateX(-${cameraX}px)`;

    requestAnimationFrame(gameLoop);
}
gameLoop();
</script>
</body>
</html>
